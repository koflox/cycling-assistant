# Module Structure

The project is organized into three module categories: **app**, **feature**, and **shared**.

## Module Tree

```
CyclingAssistant/
├── app/                              # Shell — navigation, theme, Koin bootstrap, Room DB
├── feature/
│   ├── bridge/                       # Cross-feature communication (alphabetical pair names)
│   │   ├── destination-nutrition/    # destinations ↔ nutrition
│   │   ├── destination-session/      # destinations ↔ session
│   │   ├── nutrition-session/        # nutrition ↔ session
│   │   ├── nutrition-settings/       # nutrition ↔ settings
│   │   └── profile-session/          # profile ↔ session
│   │       ├── api/                  # Interfaces exposed to consumers
│   │       └── impl/                 # Implementations wiring to provider internals
│   ├── dashboard/                    # Main dashboard with expandable menu
│   ├── destinations/                 # Destination selection feature
│   ├── nutrition/                    # Nutrition tracking and reminders
│   ├── profile/                      # Rider profile management
│   ├── session/                      # Session tracking with foreground service
│   └── settings/                     # App settings (theme, language)
└── shared/
    ├── concurrent/                   # Coroutine dispatchers, suspendRunCatching
    ├── design-system/                # UI theme, colors, spacing, components
    ├── di/                           # Koin qualifiers
    ├── distance/                     # Distance calculator
    ├── error/                        # Error mapping utilities
    ├── graphics/                     # Bitmap utilities
    ├── id/                           # ID generator
    ├── location/                     # Location services (validator, smoother, data sources)
    └── testing/                      # Test utilities
```

### app

The shell module — owns the `AppDatabase` (Room), `AppNavHost` navigation wiring, theme setup, and the root Koin module (`Modules.kt`). Every feature and shared module is included here.

### feature

Each feature module contains `di/`, `domain/`, `data/`, and `presentation/` packages. Features are fully isolated and communicate only through [bridge modules](bridge-pattern.md).

Bridge modules live under `feature/bridge/` and are named as alphabetically-ordered pairs of the two features they connect (e.g., `destination-session`, not `session-destination`). Each bridge has an `api/` submodule (interfaces) and an `impl/` submodule (wiring to the provider).

### shared

Utility modules consumed by features:

| Module          | Purpose                                          |
|-----------------|--------------------------------------------------|
| `concurrent`    | Coroutine dispatchers, `suspendRunCatching`      |
| `design-system` | Material 3 theme, colors, spacing, components    |
| `di`            | Koin qualifier definitions                       |
| `distance`      | Distance calculator                              |
| `error`         | Error mapping utilities                          |
| `graphics`      | Bitmap utilities                                 |
| `id`            | ID generator                                     |
| `location`      | Location services, validation, smoothing         |
| `testing`       | Shared test utilities (`MainDispatcherRule`, etc) |

## Module Dependency Graph

The full dependency graph is auto-generated by CI on each push to `main`. View the standalone page: [Module Graph](../MODULE_GRAPH.md).

--8<-- "docs/MODULE_GRAPH.md:3:"
